<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro">

  <xacro:macro name="chesspiece" params="parent piecename color *origin">
    <joint name="${piecename}_joint" type="floating">
      <insert_block name="origin" />
      <parent link="${parent}"/>
      <child link="${piecename}"/>
    </joint>
    <link name="${piecename}">
      <inertial>
	<mass value="${piece_mass}" />
	<!-- center of mass (com) is defined w.r.t. link local coordinate system -->
	<origin xyz="0 0 0.025" /> 

	<inertia  ixx="${(3*piece_radius*piece_radius + piece_length*piece_length)*piece_mass/12}"
		  ixy="0"
		  ixz="0"
		  iyy="${(3*piece_radius*piece_radius + piece_length*piece_length)*piece_mass/12}"
		  iyz="0"
		  izz="${piece_radius*piece_radius*piece_mass/2}"/>
      </inertial>
      <visual>
	<origin xyz="0 0 0.025" rpy="0 0 0" />
	<geometry>
	  <cylinder radius="${piece_radius}" length="${piece_length}"/>
	</geometry>
      </visual>
      <collision>
	<origin xyz="0 0 0.025" rpy="0 0 0" />
	<geometry>
	  <cylinder radius="${piece_radius}" length="${piece_length}"/>
	</geometry>
      </collision>
    </link>
    <gazebo reference="${piecename}">
      <turnGravityOff>false</turnGravityOff>
      <genTexCoord>true</genTexCoord>
      <kp>100000000.0</kp>
      <kd>1000000.0</kd>
      <material>Gazebo/${color}</material>
      <selfCollide>true</selfCollide>
    </gazebo>
  </xacro:macro>
</robot>
